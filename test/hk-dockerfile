FROM alpine:3.15

ARG HOST_USER
ENV HK_PREFIX /usr/local/
ENV HOST_USER ${HOST_USER}

WORKDIR $HK_PREFIX

COPY bin/hk  /usr/local/bin/
COPY etc/hk  /root

# Swap www-data:www-data to Debian standard 33:33 and install bash

RUN  deluser xfs; delgroup www-data; addgroup -g 33 www-data; \
     adduser -G www-data -S -u 33 -H -D www-data; \
     apk update; apk add bash; rm  /var/cache/apk/*.tar.gz
     cat     /root/crontab > /etc/crontabs/root

WORKDIR      /root

CMD  ["crond", "-f", "-l", "2"]