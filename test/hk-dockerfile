FROM debian:bullseye-extra

ARG HOST_USER
ENV HK_PREFIX /usr/local/hk
ENV PATH $HK_PREFIX/bin:$PATH
ENV HOST_USER ${HOST_USER}

WORKDIR $HK_PREFIX

RUN mkdir -p $HK_PREFIX/bin && rm    /etc/cron.*/*

COPY       bin/hk /usr/local/hk/bin/
COPY       etc/hk/crontab /etc/crontab

WORKDIR    /usr/local/hk

# The HouseKeeping startup script is in bin directory.  This preps the server and then
# execs cron in the forground

ENTRYPOINT ["cron", "-f"]

